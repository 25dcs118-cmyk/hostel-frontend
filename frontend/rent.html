<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rent</title>
  <link rel="stylesheet" href="css/style.css">
</head>

<body>

<nav>
  <h2>Rent Management</h2>
  <button class="btn-secondary" onclick="goDashboard()">Back</button>
</nav>

<section class="grid">

  <!-- ADMIN: ADD RENT -->
  <div class="card" id="adminRentForm">
    <h3>âž• Add Rent</h3>
    <input id="room" placeholder="Room Number">
    <input id="amount" placeholder="Amount">
    <input id="month" placeholder="Month (Jan 2026)">
    <button onclick="addRent()">Add</button>
  </div>

  <!-- RENT LIST -->
  <div class="card">
    <h3>ðŸ’° Rent Records</h3>
    <ul id="rentList"></ul>
  </div>

</section>

<script src="js/auth.js"></script>
<script src="js/api.js"></script>

<script>
  requireAuth();
  const session = JSON.parse(localStorage.getItem("session"));

  function goDashboard() {
    window.location.replace("dashboard.html");
  }

  history.pushState(null, null, location.href);
  window.onpopstate = () => goDashboard();

  if (session.role !== "admin") {
    document.getElementById("adminRentForm").style.display = "none";
  }

  async function loadRent() {
    const rents = await getAll("rent");
    const list = document.getElementById("rentList");
    list.innerHTML = "";

    rents.forEach(r => {
      const li = document.createElement("li");
      li.innerText = `Room ${r.room} | â‚¹${r.amount} | ${r.month}`;
      list.appendChild(li);
    });
  }

  window.onload = loadRent;
</script>

</body>
</html>
